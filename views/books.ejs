<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Book List</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <h1>Book List</h1>
  <% if (role === 'admin') { %>
    <a href="/books/new">Add New Book</a>
  <% } %>
  <a href="/logout" style="margin-left: 20px;">Logout</a>

  <h2>Search Books</h2>
  <form action="/books" method="get">
    <label>Title:</label><input type="text" name="title" value="<%= searchQuery?.title || '' %>"><br>
    <label>Author:</label><input type="text" name="author" value="<%= searchQuery?.author || '' %>"><br>
    <label>Year:</label><input type="number" name="year" value="<%= searchQuery?.year || '' %>"><br>
    <label>Genre:</label><input type="text" name="genre" value="<%= searchQuery?.genre || '' %>"><br>
    <button type="submit">Search</button>
  </form>

  <ul>
    <% books.forEach(book => { %>
      <li>
        <%= book.title %> by <%= book.author %> (<%= book.year %>) - <%= book.genre %>
        <% if (role === 'admin') { %>
          <a href="/books/<%= book._id %>/edit">Edit</a>
          <form action="/books/<%= book._id %>/delete" method="post" style="display: inline;">
            <button type="submit" onclick="return confirm('Are you sure you want to delete this book?');">Delete</button>
          </form>
        <% } %>
      </li>
    <% }); %>
  </ul>
</body>
</html>
